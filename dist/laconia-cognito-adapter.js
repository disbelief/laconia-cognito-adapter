!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["mote-models"]=t():e["mote-models"]=t()}(this,(function(){return function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=1)}([function(e,t){e.exports=function(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},function(e,t,s){"use strict";s.r(t);class r{constructor(e,t){this.app=e,this.inputConverter=t}async handle(e,t){const s=await this.inputConverter.convert(e);return this.app(s,t)}toFunction(){return this.handle.bind(this)}}class n extends r{async handle(e,t){return t.context.callbackWaitsForEmptyEventLoop=!1,super.handle(e,t)}}var i=s(0),o=s.n(i);class a{constructor({request:e,response:t}){const{userAttributes:s}=e;this.userAttributes=s,this.cognitoId=this.userAttributes.sub,this.response=t}static fromRaw(e){return new this(e)}}class u extends a{constructor(e){super(e);const{request:{userAttributes:t,validationData:s,newDeviceUsed:r},response:{autoConfirmUser:n,autoVerifyEmail:i,autoVerifyPhone:o}}=e;this.userAttributes=t,this.validationData=s,this.newDeviceUsed=r,this.autoConfirmUser=n,this.autoVerifyEmail=i,this.autoVerifyPhone=o}}class c extends a{constructor(e){super(e);const{request:{userAttributes:t,session:s},response:{challengeName:r,issueTokens:n,failAuthentication:i}}=e;this.userAttributes=t,this.session=s,this.challengeName=r,this.issueTokens=n,this.failAuthentication=i}isChallengeFailure(){return this.session&&this.session.length>=3&&!1===this.session.slice(-1)[0].challengeResult}isChallengeSuccess(){return this.session&&this.session.length&&!0===this.session.slice(-1)[0].challengeResult}}class l extends a{constructor(e){super(e);const{request:{userAttributes:t,session:s,challengeName:r},response:{publicChallengeParameters:n,privateChallengeParameters:i,challengeMetadata:o}}=e;this.userAttributes=t,this.session=s,this.challengeName=r,this.publicChallengeParameters=n,this.privateChallengeParameters=i,this.challengeMetadata=o}isNewSession(){return!this.session||!this.session.length}getPreviousCode(){return this.session.slice(-1)[0].challengeMetadata.match(/CODE-(\d*)/)[1]}}class h extends a{constructor(e){super(e);const{request:{userAttributes:t,privateChallengeParameters:s,challengeAnswer:r},response:{answerCorrect:n}}=e;this.userAttributes=t,this.privateChallengeParameters=s,this.challengeAnswer=r,this.answerCorrect=n}isCorrectAnswer(){if(!this.privateChallengeParameters||!this.privateChallengeParameters.secretLoginCode)return!1;const e=this.privateChallengeParameters.secretLoginCode;return this.challengeAnswer===e}}class g extends a{constructor(e){super(e);const{request:{userAttributes:t,groupConfiguration:s,groupsToOverride:r,iamRolesToOverride:n,preferredRole:i},response:{claimsOverrideDetails:o}}=e;this.userAttributes=t,this.groupConfiguration=s,this.groupsToOverride=r,this.iamRolesToOverride=n,this.preferredRole=i,this.claimsOverrideDetails=o}}class p extends a{constructor(e){super(e);const{request:{password:t},response:{userAttributes:s,finalUserStatus:r,messageAction:n,desiredDeliveryMediums:i,forceAliasCreation:o}}=e;this.password=t,this.userAttributes=s,this.finalUserStatus=r,this.messageAction=n,this.desiredDeliveryMediums=i,this.forceAliasCreation=o}}class f extends a{constructor(e){super(e);const{request:{userAttributes:t,codeParameter:s,usernameParameter:r},response:{smsMessage:n,emailMessage:i,emailSubject:o}}=e;this.userAttributes=t,this.codeParameter=s,this.usernameParameter=r,this.smsMessage=n,this.emailMessage=i,this.emailSubject=o}}function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function m(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(s,!0).forEach((function(t){o()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const b={authentication:["PreSignUp_SignUp","PreSignUp_AdminCreateUser","PostConfirmation_ConfirmSignUp","PostConfirmation_ConfirmForgotPassword","PreAuthentication_Authentication","PostAuthentication_Authentication"],custom_authentication:["DefineAuthChallenge_Authentication","CreateAuthChallenge_Authentication","VerifyAuthChallengeResponse_Authentication"],pre_token:["TokenGeneration_HostedAuth","TokenGeneration_Authentication","TokenGeneration_NewPasswordChallenge","TokenGeneration_AuthenticateDevice","TokenGeneration_RefreshTokens"],user_migration:["UserMigration_Authentication","UserMigration_ForgotPassword"],custom_message:["CustomMessage_SignUp","CustomMessage_AdminCreateUser","CustomMessage_ResendCode","CustomMessage_ForgotPassword","CustomMessage_UpdateUserAttribute","CustomMessage_VerifyUserAttribute","CustomMessage_Authentication"]},A=e=>{if(b.authentication.indexOf(e.triggerSource)>=0)return u.fromRaw(e);if(b.custom_authentication.indexOf(e.triggerSource)>=0)switch(e.triggerSource){case"DefineAuthChallenge_Authentication":return c.fromRaw(e);case"CreateAuthChallenge_Authentication":return l.fromRaw(e);case"VerifyAuthChallengeResponse_Authentication":return h.fromRaw(e);default:return null}return b.pre_token.indexOf(e.triggerSource)>=0?g.fromRaw(e):b.user_migration.indexOf(e.triggerSource)>=0?p.fromRaw(e):b.custom_message.indexOf(e.triggerSource)>=0?f.fromRaw(e):null};class C{constructor(e){this.rawEvent=e;const{version:t,triggerSource:s,region:r,userPoolId:n,userName:i,callerContext:o,request:a,response:u}=e;this.version=t,this.triggerSource=s,this.region=r,this.userPoolId=n,this.userName=i,this.callerContext=o,this.request=a,this.response=u,this.record=A(e)}setResponse(e={}){return this.response=m({},this.response,{},e),this.response}toResponse(){return m({},this.rawEvent,{response:this.response})}static fromRaw(e){return new C(e)}}class v{convert(e){return C.fromRaw(e)}}t.default=e=>new n(e,new v).toFunction()}])}));